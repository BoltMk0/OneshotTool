#N canvas 369 22 1252 730 10;
#X obj 155 25 loadbang;
#X obj -33 219 sel 0 1;
#X obj -33 286 pack f \$1;
#X msg -33 314 color \$1 -1;
#X msg -4 260 13;
#X msg -33 260 0;
#X obj 61 257 spigot;
#X obj 61 235 r globalmidi;
#X msg 138 319 0;
#X obj 280 86 r bgm\$1;
#N canvas 0 0 450 300 (subpatch) 0;
#X array bgm\$1L 1.46797e+006 float 2;
#X coords 0 300 1.46797e+006 299 200 140 0;
#X restore 527 39 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array bgm\$1R 1.46797e+006 float 2;
#X coords 0 300 1.46797e+006 299 200 140 0;
#X restore 565 39 graph;
#X obj 511 492 *~ 0;
#X msg 61 277 \$2 \$1;
#X obj 61 297 route 0;
#X obj 100 319 t a b;
#X obj 471 577 *~;
#X obj 314 528 vline~;
#X msg 314 507 \$1 50;
#X obj 530 579 *~;
#X obj 472 681 throw~ master_out_L;
#X obj 531 660 throw~ master_out_R;
#X obj 101 119 cnv 15 78 120 empty bgm\$1backdrop empty 3 54 1 8 -228856
-1 0;
#X obj 105 199 tgl 15 0 bgm\$1midilearn bgm\$1midilearnr MidiLearn
17 7 1 10 -262144 -1 -1 0 1;
#X obj 105 179 bng 15 250 50 0 bgm\$1loadtrack bgm\$1loadtrackr LoadTrack
17 7 1 10 -262144 -1 -1;
#X obj 110 138 knob 25 25 0 127 0 0 bgm\$1volume bgm\$1volumer Volume
0 -8 1 8 -262144 -261234 -1 1191 1;
#X obj 146 138 knob 25 25 0 127 0 0 bgm\$1fade bgm\$1fader Fade 0 -8
1 8 -262144 -203904 -1 0 1;
#X obj 511 469 phasor~;
#X obj 830 316 s midiout;
#X obj 830 275 pack f f;
#X msg 830 295 \$2 \$1;
#X msg 845 249 0;
#X obj 818 228 t f b;
#X text 858 227 <- clear previous pad before moving;
#X obj 482 442 *;
#X msg 155 45 63;
#X obj 157 102 cnv 15 20 15 empty bgm\$1midicnv _ -6 7 1 14 -228856
-66577 0;
#X obj 384 66 r to_midi;
#X obj 384 87 route;
#N canvas 1323 420 543 300 handlemidiset 0;
#X obj 62 28 inlet;
#X obj 63 60 sel 0;
#X msg 63 93 0;
#X obj 157 115 i;
#X obj 106 92 t f f f b;
#X obj 106 116 outlet;
#X obj 182 278 s bgm\$1midicnv;
#X msg 182 228 label _\$1;
#X msg 94 156 symbol;
#X obj -96 201 s bgm\$1playcmd;
#X msg 157 136 \; to_midi \$1 midilink 0;
#X obj 48 202 s bgm\$1midilink;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 4 0;
#X connect 2 0 8 0;
#X connect 2 0 9 0;
#X connect 2 0 11 0;
#X connect 3 0 10 0;
#X connect 4 0 5 0;
#X connect 4 0 7 0;
#X connect 4 1 11 0;
#X connect 4 2 3 1;
#X connect 4 3 3 0;
#X connect 7 0 6 0;
#X connect 8 0 7 0;
#X restore 332 155 pd handlemidiset;
#N canvas 1014 492 450 300 playstate_handler 0;
#X obj 81 12 r bgm\$1playstate;
#X obj 83 165 s bgm\$1backdrop;
#X msg 80 134 color 6 -1;
#X obj 81 95 sel 0 1 2;
#X obj 212 54 r bgm\$1samplesize;
#X msg 212 75 bang;
#X msg 153 134 color 8 -1;
#X msg 227 135 color 7 -1;
#X connect 0 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 3 1 6 0;
#X connect 3 2 7 0;
#X connect 4 0 5 0;
#X connect 5 0 2 0;
#X connect 6 0 1 0;
#X connect 7 0 1 0;
#X restore 713 62 pd playstate_handler;
#X obj 486 544 *~;
#X obj 552 551 *~;
#X obj 710 524 vline~;
#X obj 754 394 r bgm\$1fade;
#X obj 710 502 pack f f;
#X obj 478 371 delay;
#X obj 428 309 sel 0;
#X obj 709 371 r bgm\$1playcmd;
#X obj 428 234 r bgm\$1playcmd;
#X msg 478 392 0;
#X obj 478 412 t f f;
#X obj 526 392 r bgm\$1samplesize;
#X obj 560 469 r bgm\$1samplesize;
#N canvas 1286 588 450 300 sampleloader 0;
#X obj 50 -5 inlet;
#X obj 50 14 route bang;
#X obj 50 35 openpanel;
#X obj 50 191 soundfiler;
#X msg 50 169 read -resize \$1 bgm\$2L bgm\$2R;
#X obj 50 87 pack s \$1;
#X obj 50 214 s bgm\$1samplesize;
#X obj 191 0 r bgm\$1loadtrack;
#X obj 295 81 splitfilename;
#X obj 69 141 s bgm\$1fullname;
#X obj 295 59 r bgm\$1fullname;
#X obj 370 102 s bgm\$1filename;
#X obj 292 175 r bgm\$1filename;
#X obj 292 216 s bgm\$1backdrop;
#X msg 292 195 label \$1;
#X msg 69 119 symbol \$1;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 5 0;
#X connect 2 0 5 0;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 5 0 4 0;
#X connect 5 0 15 0;
#X connect 7 0 2 0;
#X connect 8 1 11 0;
#X connect 10 0 8 0;
#X connect 12 0 14 0;
#X connect 14 0 13 0;
#X connect 15 0 9 0;
#X restore 476 152 pd sampleloader;
#X obj 468 303 r bgm\$1playstate;
#X obj 428 330 spigot;
#X obj 375 415 s bgm\$1playstate;
#X msg 426 390 1;
#X obj 95 441 r globalmidi;
#X obj 95 483 route;
#X obj 95 558 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 95 578 s bgm\$1playcmd;
#X obj 95 506 sel 0;
#X msg 122 529 bang;
#X obj 588 521 tabread4~ bgm\$1R;
#X obj 481 521 tabread4~ bgm\$1L;
#X obj 526 412 expr 44100/$f1;
#X floatatom 468 464 5 0 0 0 - - -;
#X obj 754 416 expr $f1*$f1;
#X obj 505 350 r bgm\$1fadetime;
#X obj 769 502 s bgm\$1fadetime;
#X obj 754 438 t b f f;
#X obj 702 552 *~;
#X msg 478 329 stop;
#N canvas 612 393 949 414 saver 0;
#X obj 106 25 r bgm\$1fullname;
#X obj 127 45 r bgm\$1volume;
#X obj 148 69 r bgm\$1fade;
#X obj 85 -17 inlet;
#X msg 85 4 bang;
#X obj 240 360 textfile;
#X obj 82 365 print Saved;
#X obj 92 248 r sessiondir;
#X obj 48 269 pack f s;
#X msg 48 220 \$1;
#X obj 91 322 t s s;
#X msg 141 339 write \$1;
#X msg 48 291 symbol \$2/bgm\$1.conf;
#X obj 169 90 r bgm\$1midilink;
#X msg 158 181 set name bgm\$1 \, add filename \$2 \, add volume \$3
\, add fade \$4 \, add midilink \$5 \, add mono \$6;
#X obj 85 132 pack \$1 s 63 0 0 0;
#X obj 190 111 r bgm\$1mono;
#X obj 85 153 t a a;
#X connect 0 0 15 1;
#X connect 1 0 15 2;
#X connect 2 0 15 3;
#X connect 3 0 4 0;
#X connect 4 0 15 0;
#X connect 7 0 8 1;
#X connect 8 0 12 0;
#X connect 9 0 8 0;
#X connect 10 0 6 0;
#X connect 10 1 11 0;
#X connect 11 0 5 0;
#X connect 12 0 10 0;
#X connect 13 0 15 4;
#X connect 14 0 5 0;
#X connect 15 0 17 0;
#X connect 16 0 15 5;
#X connect 17 0 9 0;
#X connect 17 1 14 0;
#X restore 280 132 pd saver;
#X obj 314 465 r bgm\$1volume;
#X obj 314 486 expr exp(4.16*$f1/127-2.08);
#X msg 384 375 2;
#X obj 385 178 s bgm\$1volumer;
#X obj 436 200 s bgm\$1fader;
#X obj 461 257 r bgm\$1samplesize;
#X obj 428 280 spigot;
#X obj 588 149 route ping;
#X obj 588 170 s ping;
#X obj 346 42 r global;
#N canvas 612 393 949 508 loader 0;
#X obj 72 82 pack \$1 s;
#X obj 123 60 r sessiondir;
#X obj 72 125 s loader;
#X msg 72 104 \$2/bgm\$1.conf;
#X msg 72 62 bang;
#X obj 72 42 inlet;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 3 0 2 0;
#X connect 4 0 0 0;
#X connect 5 0 4 0;
#X restore 803 109 pd loader;
#X obj 645 169 print [WN] Unrecognised bgm command;
#X obj 280 112 route save midilink;
#X msg 100 342 midilink \$2;
#X obj 470 108 print bgm\$1;
#X obj 451 66 r bgm\$1midilink;
#X obj 122 462 r bgm\$1midilink;
#X obj 105 219 tgl 15 0 bgm\$1mono bgm\$1monor Mono 17 7 1 10 -262144
-1 -1 0 1;
#X obj 385 132 route volume fade filename mono;
#X obj 522 190 s bgm\$1monor;
#X obj 480 602 *~ 0;
#X obj 542 603 *~ 0;
#X obj 563 579 r bgm\$1mono;
#X connect 0 0 35 0;
#X connect 1 0 5 0;
#X connect 1 1 4 0;
#X connect 2 0 3 0;
#X connect 3 0 23 0;
#X connect 4 0 2 0;
#X connect 5 0 2 0;
#X connect 6 0 13 0;
#X connect 7 0 6 0;
#X connect 8 0 23 0;
#X connect 9 0 88 0;
#X connect 9 0 90 0;
#X connect 12 0 65 0;
#X connect 12 0 66 0;
#X connect 13 0 14 0;
#X connect 14 1 15 0;
#X connect 15 0 89 0;
#X connect 15 1 8 0;
#X connect 16 0 20 0;
#X connect 16 0 96 0;
#X connect 17 0 16 0;
#X connect 17 0 19 0;
#X connect 18 0 17 0;
#X connect 19 0 21 0;
#X connect 19 0 97 0;
#X connect 23 0 1 0;
#X connect 23 0 6 1;
#X connect 27 0 12 0;
#X connect 29 0 30 0;
#X connect 30 0 28 0;
#X connect 31 0 29 0;
#X connect 32 0 29 1;
#X connect 32 1 31 0;
#X connect 34 0 27 0;
#X connect 34 0 68 0;
#X connect 35 0 25 0;
#X connect 37 0 38 0;
#X connect 38 0 88 0;
#X connect 41 0 16 1;
#X connect 42 0 19 1;
#X connect 43 0 73 0;
#X connect 43 0 73 1;
#X connect 44 0 69 0;
#X connect 45 0 43 0;
#X connect 46 0 50 0;
#X connect 47 0 56 0;
#X connect 47 1 34 0;
#X connect 47 1 58 0;
#X connect 47 1 74 0;
#X connect 48 0 45 0;
#X connect 49 0 82 0;
#X connect 50 0 51 0;
#X connect 50 0 57 0;
#X connect 51 0 27 1;
#X connect 51 1 27 0;
#X connect 51 1 68 0;
#X connect 52 0 67 0;
#X connect 53 0 12 1;
#X connect 55 0 56 1;
#X connect 56 0 46 0;
#X connect 56 0 78 0;
#X connect 58 0 57 0;
#X connect 59 0 60 0;
#X connect 60 0 63 0;
#X connect 61 0 62 0;
#X connect 63 1 64 0;
#X connect 64 0 61 0;
#X connect 65 0 42 0;
#X connect 66 0 41 0;
#X connect 67 0 34 1;
#X connect 69 0 72 0;
#X connect 70 0 46 1;
#X connect 72 0 45 0;
#X connect 72 1 45 1;
#X connect 72 2 71 0;
#X connect 73 0 41 1;
#X connect 73 0 42 1;
#X connect 74 0 46 0;
#X connect 76 0 77 0;
#X connect 77 0 18 0;
#X connect 78 0 57 0;
#X connect 81 0 82 1;
#X connect 82 0 47 0;
#X connect 83 0 84 0;
#X connect 83 1 87 0;
#X connect 85 0 88 0;
#X connect 88 0 75 0;
#X connect 88 1 39 0;
#X connect 88 2 94 0;
#X connect 89 0 88 0;
#X connect 91 0 38 1;
#X connect 92 0 60 1;
#X connect 94 0 79 0;
#X connect 94 1 80 0;
#X connect 94 2 54 0;
#X connect 94 3 95 0;
#X connect 94 4 83 0;
#X connect 96 0 21 0;
#X connect 97 0 20 0;
#X connect 98 0 97 1;
#X connect 98 0 96 1;
#X coords 0 -1 1 1 80 140 1 100 100;
